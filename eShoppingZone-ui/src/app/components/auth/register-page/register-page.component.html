<app-alert-box [alert]="alert"></app-alert-box>
<div class="row">
    <div class="col-xs-12 col-md-6 col-md-offset-3 mx-auto my-5">
        <h2>Register</h2>
        <hr style="color: #565656; min-width: 80%; margin-right: 5px" />
        <div *ngIf="isLoading; then thenBlock else elseBlock"></div>
        <ng-template #thenBlock>
            <div class="mx-auto spinner-border text-primary" role="status">
                <span class="sr-only">Loading...</span>
            </div>
        </ng-template>
        <ng-template #elseBlock>
            <form [formGroup]="form" (ngSubmit)="onSubmit()">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" class="form-control" name="username" formControlName="username" />
                    <span class="help-block" *ngIf="!form.get('username').valid && form.get('username').touched">Please
                        enter a
                        username</span>
                </div>
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" class="form-control" name="email" required email
                        formControlName="email" />
                    <span class="help-block" *ngIf="!form.get('email').valid && form.get('email').touched">Please enter
                        a
                        valid email</span>
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" class="form-control" name="password" required
                        formControlName="password" />
                    <span class="help-block" *ngIf="!form.get('password').valid && form.get('password').touched">Please
                        enter a
                        valid password (Mininimum 6 characters)</span>
                </div>
                <div class="form-group">
                    <label for="mobileNumber">Mobile Number</label>
                    <input type="tel" id="mobileNumber" class="form-control" name="mobileNumber"
                        formControlName="mobileNumber" />
                    <span class="help-block"
                        *ngIf="!form.get('mobileNumber').valid && form.get('mobileNumber').touched">Please enter a
                        valid Mobile Number</span>
                </div>
                <div class="form-group">
                    <label for="about">About</label>
                    <textarea class="form-control" id="about" name="about" rows="3" formControlName="about"></textarea>
                    <span class="help-block" *ngIf="!form.get('about').valid && form.get('about').touched">Please write
                        something about yourself</span>
                </div>
                <div class="form-group">
                    <label for="dateOfBirth">Date Of Birth</label>
                    <input id="dateOfBirth" class="form-control" type="date" name="dateOfBirth"
                        formControlName="dateOfBirth">
                    <span class="help-block"
                        *ngIf="!form.get('dateOfBirth').valid && form.get('dateOfBirth').touched">Please enter
                        a valid birth date
                    </span>
                </div>
                <div class="form-group form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="gender" id="Male" value="Male"
                        formControlName="gender">
                    <label class="form-check-label" for="Male">Male</label>
                </div>
                <div class="form-group form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="gender" id="Female" value="Female"
                        formControlName="gender">
                    <label class="form-check-label" for="Female">Female</label>
                </div>
                <div class="form-group form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="gender" id="Other" value="Other"
                        formControlName="gender">
                    <label class="form-check-label" for="Other">Other</label>
                </div>
                <span class="help-block" *ngIf="!form.get('gender').valid && form.get('gender').touched">Please select a
                    gender
                </span>
                <div class="form-group">
                    <label for="role">Role</label>
                    <select class="form-select" name="role" formControlName="role">
                        <option value="Customer">Customer</option>
                        <option value="Merchant">Merchant</option>
                    </select>
                </div>
                <div class="form-group address-group col-md-12" formArrayName="address">
                    <label for="addresses">Addresses</label>
                    <div *ngFor="let address of addressForms.controls; let i = index">
                        <div class="d-flex justify-content-between">Address {{i+1}} <span type="button"
                                (click)="removeAddress(i)">Remove
                                Address<i class="fa-solid fa-minus text-primary px-2"></i></span>
                        </div>
                        <div [formGroupName]="i">
                            <div class="form-group row">
                                <div class="col-md-4">
                                    <input type="text" class="form-control" placeholder="House Number"
                                        formControlName="houseNumber">
                                </div>
                                <div class="col-md-8">
                                    <input type="text" class="form-control" placeholder="Street Name"
                                        formControlName="streetName">
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="col-md-12"> <input type="text" class="form-control" placeholder="Colony"
                                        formControlName="colonyName">
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="col-md-4">
                                    <input type="text" class="form-control" placeholder="City" formControlName="city">
                                </div>
                                <div class="col-md-4">
                                    <input type="text" class="form-control" placeholder="State" formControlName="state">
                                </div>
                                <div class="col-md-4">
                                    <input type="text" class="form-control" placeholder="Pincode"
                                        formControlName="pincode">
                                </div>
                            </div>
                            <hr style="color: #565656; min-width: 80%; margin-right: 5px" />

                        </div>
                    </div>

                    <span class="mx-auto" type="button" (click)="addAddress()">Add Address<i
                            class="fa-solid fa-plus text-primary px-2"></i></span>
                </div>
                <div class="my-3">
                    <button class="btn btn-lg btn-primary" type="submit" [disabled]="!form.valid">
                        Signup</button> |
                    <a routerLink="/login">Switch to Login</a>
                </div>
            </form>
        </ng-template>
    </div>
</div>